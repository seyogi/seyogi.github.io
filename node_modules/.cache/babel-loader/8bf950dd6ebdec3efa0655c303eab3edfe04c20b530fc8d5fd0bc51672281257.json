{"ast":null,"code":"import { axios } from \"../../axios/index\";\nimport { doc, getDoc, setDoc, updateDoc } from \"firebase/firestore\";\nimport LoadingAnimationComponent from \"./LoadingAnimationComponent.vue\";\nimport Firebase from \"../../firebase_settings/index.js\";\nconst db = Firebase.db;\nexport default {\n  components: {\n    LoadingAnimationComponent\n  },\n  data() {\n    return {\n      errmsg: \"\",\n      uploadFile: null,\n      csvText: \"\",\n      config: {\n        headers: {\n          \"content-type\": \"multipart/form-data\"\n        }\n      }\n    };\n  },\n  methods: {\n    selectedFile: function (e) {\n      e.preventDefault();\n      let files = e.target.files;\n      this.uploadFile = files[0];\n    },\n    changeTextArea: function () {\n      let csvTextArea = document.getElementById(\"csvTextArea\");\n      this.csvText = csvTextArea.value;\n    },\n    click() {\n      this.errmsg = \"\";\n      var formData = new FormData();\n      if (this.uploadFile) {\n        formData.append(\"file\", this.uploadFile);\n        this.send_file(formData).then(response => {\n          console.log(response.data.message);\n          this.send_userData(response.data.message, this.$parent.user.uid);\n        });\n      } else if (this.csvText != \"\") {\n        formData.append(\"text\", this.csvText);\n        this.send_text(formData).then(response => {\n          //this.$parent.scoreDatas = response.data.message;\n          console.log(response.data.message);\n        });\n      } else {\n        this.errmsg = \"ファイルまたはテキストを入力してください\";\n      }\n    },\n    send_file(file) {\n      return axios.post(\"iidx/uploadfile/\", file, this.config);\n    },\n    send_text(text) {\n      return axios.post(\"iidx/uploadtext/\", text, this.config);\n    },\n    send_userData(data, uid) {\n      //Firestore\n      const docRef = doc(db, \"userData\", uid);\n      getDoc(docRef).then(documentSnapshot => {\n        if (documentSnapshot.exists()) {\n          updateDoc(docRef, {});\n          updateDoc(docRef, data).then(() => {\n            console.log(\"Document successfully update!\");\n          }).catch(error => {\n            console.error(\"Error writing document: \", error);\n          });\n        } else {\n          setDoc(docRef, data).then(() => {\n            console.log(\"Document successfully written!\");\n          }).catch(error => {\n            console.error(\"Error writing document: \", error);\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","doc","getDoc","setDoc","updateDoc","LoadingAnimationComponent","Firebase","db","components","data","errmsg","uploadFile","csvText","config","headers","methods","selectedFile","e","preventDefault","files","target","changeTextArea","csvTextArea","document","getElementById","value","click","formData","FormData","append","send_file","then","response","console","log","message","send_userData","$parent","user","uid","send_text","file","post","text","docRef","documentSnapshot","exists","catch","error"],"sources":["C:\\Users\\taich\\Documents\\GitHub\\home\\src\\components\\iidxradarparts\\iidxListSet.vue"],"sourcesContent":["<template>\r\n  <div class=\"main_box\">\r\n    <br />\r\n    ※同一曲について複数譜面タイプ（B/N/H/A/L）をプレーしている場合、それらの中の最大値のみが対象として適用されます\r\n    <br />\r\n    <textarea\r\n      id=\"csvTextArea\"\r\n      name=\"csv_text\"\r\n      rows=\"10\"\r\n      cols=\"33\"\r\n      @change=\"changeTextArea\"\r\n    />\r\n    <br />\r\n    <input type=\"file\" id=\"csvFile\" name=\"avatar\" accept=\".csv\" @change=\"selectedFile\" />\r\n    <br /><br />{{ this.errmsg }}\r\n    <br />\r\n    <input type=\"button\" id=\"sendButton\" value=\"Go\" @click=\"click()\" />\r\n    <br />\r\n    <div class=\"loading_animation_container\">\r\n      <div class=\"loading_animation\" v-if=\"this.isLoading\">\r\n        <LoadingAnimationComponent :uid=\"user\"></LoadingAnimationComponent>\r\n      </div>\r\n    </div>\r\n    <br />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { axios } from \"../../axios/index\";\r\nimport { doc, getDoc, setDoc, updateDoc } from \"firebase/firestore\";\r\nimport LoadingAnimationComponent from \"./LoadingAnimationComponent.vue\";\r\nimport Firebase from \"../../firebase_settings/index.js\";\r\n\r\nconst db = Firebase.db;\r\n\r\nexport default {\r\n  components: {\r\n    LoadingAnimationComponent,\r\n  },\r\n  data() {\r\n    return {\r\n      errmsg: \"\",\r\n      uploadFile: null,\r\n      csvText: \"\",\r\n      config: {\r\n        headers: {\r\n          \"content-type\": \"multipart/form-data\",\r\n        },\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    selectedFile: function (e) {\r\n      e.preventDefault();\r\n      let files = e.target.files;\r\n      this.uploadFile = files[0];\r\n    },\r\n    changeTextArea: function () {\r\n      let csvTextArea = document.getElementById(\"csvTextArea\");\r\n      this.csvText = csvTextArea.value;\r\n    },\r\n    click() {\r\n      this.errmsg = \"\";\r\n      var formData = new FormData();\r\n      if (this.uploadFile) {\r\n        formData.append(\"file\", this.uploadFile);\r\n        this.send_file(formData).then((response) => {\r\n          console.log(response.data.message);\r\n          this.send_userData(response.data.message, this.$parent.user.uid);\r\n        });\r\n      } else if (this.csvText != \"\") {\r\n        formData.append(\"text\", this.csvText);\r\n        this.send_text(formData).then((response) => {\r\n          //this.$parent.scoreDatas = response.data.message;\r\n          console.log(response.data.message);\r\n        });\r\n      } else {\r\n        this.errmsg = \"ファイルまたはテキストを入力してください\";\r\n      }\r\n    },\r\n    send_file(file) {\r\n      return axios.post(\"iidx/uploadfile/\", file, this.config);\r\n    },\r\n    send_text(text) {\r\n      return axios.post(\"iidx/uploadtext/\", text, this.config);\r\n    },\r\n\r\n    send_userData(data, uid) {\r\n      //Firestore\r\n      const docRef = doc(db, \"userData\", uid);\r\n      getDoc(docRef).then((documentSnapshot) => {\r\n        if (documentSnapshot.exists()) {\r\n          updateDoc(docRef, {});\r\n          updateDoc(docRef, data)\r\n            .then(() => {\r\n              console.log(\"Document successfully update!\");\r\n            })\r\n            .catch((error) => {\r\n              console.error(\"Error writing document: \", error);\r\n            });\r\n        } else {\r\n          setDoc(docRef, data)\r\n            .then(() => {\r\n              console.log(\"Document successfully written!\");\r\n            })\r\n            .catch((error) => {\r\n              console.error(\"Error writing document: \", error);\r\n            });\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.main_box {\r\n  text-align: center;\r\n  margin: auto;\r\n  width: 98%;\r\n}\r\ninput[type=\"text\"] {\r\n  width: 200px;\r\n  height: 200px;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}